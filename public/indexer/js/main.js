/**
 * @license
 * 
 * <eyy-indexer-main> [https://github.com/sixem/eyy-indexer]
 * 
 * Licensed under GPL-3.0
 * @author   emy [admin@eyy.co]
 * @version  1.1.5
 */
"use strict";function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}!function(){var u={store:{defaults:{},selection:{},selected:null,gallery:null,refresh:!1},debounce:function(t){var n;return function(e){n&&clearTimeout(n),n=setTimeout(t,100,e)}},getReadableSize:function(e){var t=0<arguments.length&&void 0!==e?e:0;if(0===t)return"0.00 B";var n=_toConsumableArray(config.format.sizes),r=-1;for(n.shift();r++,1024<(t/=1024););return Math.max(t,.1).toFixed(1)+n[r]},capitalize:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},fallbackCopyTextToClipboard:function(e){var t=document.createElement("textarea");t.value=e,t.style.position="fixed",document.body.appendChild(t),t.focus(),t.select();try{var n=document.execCommand("copy");config.debug&&console.log("fallback","copying text command was "+(n?"successful":"unsuccessful"))}catch(e){config.debug&&console.error("fallback","unable to copy",e)}document.body.removeChild(t)},copyTextToClipboard:function(e){navigator.clipboard?navigator.clipboard.writeText(e).then(function(){config.debug&&console.log("async","copying to clipboard was successful.")},function(e){config.debug&&console.error("async","could not copy text: ",e)}):u.fallbackCopyTextToClipboard(e)},getCellValue:function(e,t){var n=$(e).children("td").eq(t).data("raw");return void 0!==n?n:$(e).children("td").eq(t).text()},comparer:function(i){return function(e,t){var n=u.getCellValue(e,i),r=u.getCellValue(t,i);return $.isNumeric(n)&&$.isNumeric(r)?n-r:n.localeCompare(r)}},client:{get:function(){var t;try{t=JSON.parse(Cookies.get("ei-client")),["gallery","sort"].forEach(function(e){t.hasOwnProperty(e)||(t[e]={})})}catch(e){t={gallery:{},sort:{}},u.client.set(t)}return t},set:function(e,t){var n=1<arguments.length&&void 0!==t?t:{},n=Object.assign({sameSite:"lax",expires:365},n);Cookies.set("ei-client",JSON.stringify(e),n)}},settings:{close:function(){[$(".focus-overlay"),$(".settings-container")].forEach(function(e){return e.remove()})},apply:function(r,e){function t(e,t){var n=r.find(e);return 0<n.length?n[0][t]:null}var n,i,o,a,l=(l=1<arguments.length&&void 0!==e?e:null)||u.client.get(),s={theme:t("div.section.main > div > select#theme-select","selectedIndex"),gallery:{list_alignment:t("div.section.gallery > div > select#list-alignment","selectedIndex")}};s.theme&&0===s.theme?(l.theme=!1,u.theme.set(null,!1)):s.theme<=config.themes.pool.length-1&&(n=config.themes.pool[s.theme],u.theme.set(n,!1),l.theme=n),s.gallery.list_alignment&&l.gallery.hasOwnProperty("list_alignment")&&l.gallery.list_alignment!==s.gallery.list_alignment&&u.store.gallery&&((i=[".gallery-container div.content-container .media .loader",".gallery-container div.content-container .list",".gallery-container div.content-container .list > div.drag"]).forEach(function(e){return 0===s.gallery.list_alignment?$(e).removeClass("reversed"):$(e).addClass("reversed")}),o=$(i[1]).detach(),a=".gallery-container div.content-container .media",1===s.gallery.list_alignment?o.insertBefore(a):o.insertAfter(a),u.store.gallery.settings.list.reverse=0!==s.gallery.list_alignment),l.gallery.list_alignment=s.gallery.list_alignment,u.client.set(l),u.settings.close()},show:function(){var t,r,e,n,i,o,a;0<$(".settings-container").length||(0===$(".focus-overlay").length&&$("<div/>",{class:"focus-overlay"}).appendTo($("body")).on("click",function(e){u.settings.close()}),t=$("<div/>",{class:"settings-container"}),(r=u.client.get()).hasOwnProperty("gallery")||(r.gallery={}),n=function(){var e,t=$("<div/>",{class:"section gallery"}).append($("<div/>",{class:"header",text:"Gallery"})),n=0;return config.mobile||(e=$("<div/>").append($("<span/>",{text:"List Alignment: "})).append($("<select/>",{id:"list-alignment"}).append(["right","left"].map(function(e,t){return $("<option/>",{value:"align-"+e,text:u.capitalize(e)})}))),r.gallery.hasOwnProperty("list_alignment")&&e.find("> select > option").each(function(e,t){e===r.gallery.list_alignment&&(t.selected=!0,$(t).parent("select")[0].selectedIndex=e)}),n++,t.append(e)),{settings:n,section:t}},e=(e=function(){var e,t=$("<div/>",{class:"section main"}).append($("<div/>",{class:"header",text:"Main"})),n=0;return config.hasOwnProperty("themes")&&0<config.themes.pool.length&&((e=$("<div/>").append($("<span/>",{text:"Theme: "})).append($("<select/>",{id:"theme-select"}).append(config.themes.pool.map(function(e,t){return $("<option/>",{value:e,text:u.capitalize(e)})})))).find("> select > option").each(function(e,t){(null===config.themes.set&&0===e||t.value==config.themes.set)&&(t.selected=!0,$(t).parent("select")[0].selectedIndex=e)}),n++,t.append(e)),{settings:n,section:t}})(),n=n(),t.append($("<div/>",{class:"wrapper"}).append(0<e.settings?e.section:null).append(0<n.settings?n.section:null)),i=$("<div/>",{class:"bottom"}).appendTo(t),o=$("<div/>",{class:"apply ns",text:"Apply"}).appendTo(i),a=$("<div/>",{class:"cancel ns",text:"Cancel"}).appendTo(i),o.on("click",function(e){return u.settings.apply(t,r)}),a.on("click",function(e){return u.settings.close()}),$("body").append(t))}},menu:{create:function(){var n=$("<div/>",{class:"menu"}).appendTo($("body")),e=[{text:"[Show] Filter",id:"filter"},{text:"[Copy] WGET",id:"copy"}];return!0===config.gallery.enabled&&0<$("a.preview").length&&e.unshift({text:"[Open] Gallery",id:"gallery"}),e.unshift({text:"[Open] Settings",id:"settings",class:"settings"}),e.forEach(function(e){var t=$("<div/>",{text:e.text,class:"ns"+(e.hasOwnProperty("class")?" "+e.class:"")}).appendTo(n);e.hasOwnProperty("id")&&t.attr("id",e.id)}),n},toggle:function(e){var t=0<arguments.length&&void 0!==e?e:null,n=$("body > div.menu");return n.css("display","boolean"==typeof t?t?"inline-block":"none":n.is(":hidden")?"inline-block":"none"),$("body > .top-bar > div.extend").html(n.is(":hidden")?"&#x25BE;":"&#x25B4;"),n.is(":hidden")}},theme:{set:function(e,t){var n=0<arguments.length&&void 0!==e?e:null,r=!(1<arguments.length&&void 0!==t)||t,i=$('head > link[rel="stylesheet"]').filter(function(e,t){return t.hasAttribute("href")&&t.getAttribute("href").match(new RegExp("/(themes)/","i"))});if(null===(config.themes.set=n)|!n)return i.each(function(e,t){return t.remove()}),!1;r&&u.client.set(u.client.get().theme=n),$("head").append($("<link/>",{rel:"stylesheet",type:"text/css",href:"".concat(config.themes.path,"/").concat(n,".css")})),i.each(function(e,t){return t.remove()})}},filter:{apply:function(e){var o=0<arguments.length&&void 0!==e?e:null;u.store.refresh=!0;var a={reset:""===(o=o||""),shown:{directories:0,files:0},hidden:{directories:0,files:0},size:0};$("body > table tr.file, body > table tr.directory").each(function(e,t){if(t=$(t),!0===a.reset)return t.css("display",""),!0;var n,r=t.hasClass("file"),i=t.find("td:eq(0)").attr("data-raw").match(new RegExp(o,"i"));t.css("display",i?"":"none"),i&&r&&(n=t.find("td:eq(2)").attr("data-raw"),isNaN(n)||(a.size=a.size+parseInt(n))),i?r?a.shown.files++:a.shown.directories++:r?a.hidden.files++:a.hidden.directories++});var t={container:$("body > div.top-bar")};["size","files","directories"].forEach(function(e){return t[e]=t.container.find('[data-count="'.concat(e,'"]'))}),u.store.defaults.hasOwnProperty("top_values")||(u.store.defaults.top_values={size:t.size.text(),files:t.files.text(),directories:t.directories.text()}),t.size.text(a.reset?u.store.defaults.top_values.size:u.getReadableSize(a.size)),t.files.text(a.reset?u.store.defaults.top_values.files:"".concat(a.shown.files," file").concat(1===a.shown.files?"":"s")),t.directories.text(a.reset?u.store.defaults.top_values.directories:"".concat(a.shown.directories," ").concat(1===a.shown.directories?"directory":"directories"));var n=$("body > div.menu > #gallery"),r=$("body > table tr.file:visible a.preview").length;!a.reset&&0===r&&0<n.length?"none"!==n.css("display")&&n.css("display","none"):(0<r||a.reset)&&0<n.length&&"none"===n.css("display")&&n.css("display","block")},toggle:function(){var e=$(".filter-container"),t=e.find('input[type="text"]');e.is(":visible")?e.hide():(t.val(""),u.filter.apply(null),e.show()),t.focus()}},dates:{convert:function(e){return e<10?"0"+e:e},load:function(){var f,e=(new Date).getTimezoneOffset(),t=u.client.get();t.timezone_offset=e,u.client.set(t),f=e,$("tbody tr.directory > td:nth-child(2), tbody tr.file > td:nth-child(2)").each(function(e,t){var n,r,i,o,a,l,s,c,d;(t=$(t))[0].hasAttribute("data-raw")&&(r=(n=_slicedToArray((s=t.attr("data-raw"),c=u.dates.convert,d=new Date(1e3*s),["".concat(c(d.getDate()),"/").concat(c(d.getMonth()+1),"/").concat(d.getFullYear().toString().substring(2)),"".concat(c(d.getHours()),":").concat(c(d.getMinutes()))]),2))[0],i=n[1],o=0<f?-Math.abs(f):Math.abs(f),o/=60,a=$("<span/>"),(l=function(e){if(0===e)return"Now";if(e<0)return!1;for(var t={year:31556926,month:2629743,week:604800,day:86e3,hour:3600,minute:60,second:1},n=Object.keys(t),r=n.length-1,i=!1,o=0;o<n.length;o++){var a=n[o];if(!(e<=t[a])){var l=o+1<=r?n[o+1]:null,s=Math.floor(e/t[a]),c=l?Math.floor((e-s*t[a])/t[l]):0,i="".concat(s," ").concat(a).concat(1==s?"":"s")+(0<c?" and ".concat(c," ").concat(l).concat(1==c?"":"s"):"")+" ago";break}}return i}(config.timestamp-parseInt(t.attr("data-raw"))))&&a.attr("title","".concat(l," (UTC").concat((0<o?"+":"")+o,")")),a.html(r).append($("<span/>",{"data-view":"desktop",text:" "+i})),t.html(a))})}},sort:{load:function(){if(config.hasOwnProperty("sorting")&&config.sorting.enabled&&(0===config.sorting.types||1===config.sorting.types)){var e,t="asc"===config.sorting.order,n=null;switch(config.sorting.sort_by){case"name":n=0;break;case"modified":n=1;break;case"size":n=2;break;case"type":n=3;break;default:n=null}null===n||0<(e=$("table th span[sortable]").eq(n).parents("th")).length&&(e[0].asc=t,e.find("> span.sort-indicator").addClass(t?"down":"up").fadeIn(350))}}},gallery:{load:function(e){var t=0<arguments.length&&void 0!==e?e:0;if(config.debug&&console.log("gallery.load =>",t),!config.gallery.enabled)return!1;if(u.store.gallery&&!1!==u.store.gallery){var n=u.store.refresh?u.getTableItems():null;return null!==n&&0===n.length?!1:(u.store.gallery.show(!0,null===t?u.store.gallery.data.selected.index:t,n),void(u.store.refresh&&(u.store.refresh=!1)))}var r,i=u.client.get();i.hasOwnProperty("gallery")||(i.gallery={list_state:1},u.client.set(i)),r=JSON.parse(i.gallery.hasOwnProperty("list_state")?i.gallery.list_state:1),u.store.gallery=new $.fn.gallery(u.getTableItems(),{start:null===t?0:t,filter:!1,console:config.debug,fade:config.gallery.fade,mobile:config.mobile,reverse_options:config.gallery.reverse_options,scroll_interval:config.gallery.scroll_interval,list:{show:null==r||!!r,reverse:!!i.gallery.hasOwnProperty("list_alignment")&&0!==i.gallery.list_alignment}}),!1!==u.store.gallery&&$(u.store.gallery).on("unbound",function(e,t){return u.bind()})}},overlay:{hide:function(e){var t=0<arguments.length&&void 0!==e?e:function(){},n=0;[{e:$(".filter-container"),func:u.filter.toggle},{e:$("body > div.menu"),func:u.menu.toggle}].forEach(function(e){0<e.e.length&&e.e.is(":visible")&&(e.func(),n++)}),t(0<n)}},getTableItems:function(){var a=[];return $("tr.file td:first-child a.preview").each(function(e,t){var n=(t=$(t)).closest("tr");if(n.is(":hidden"))return!0;var r=t.attr("href"),i=t.closest("td").data("raw"),o=n.find("td").eq(2).text();void 0!==r&&void 0!==i&&a.push({name:i,url:r,size:o})}),a},bind:function(){$(document).off("keydown").on("keydown",function(t){var e;t.shiftKey&&70===t.keyCode?(t.preventDefault(),u.filter.toggle()):27===t.keyCode?u.overlay.hide(function(e){!0===e&&t.preventDefault()}):71===t.keyCode&&!0===config.gallery.enabled&&(!1!==(e=$(".filter-container")).is(":visible")&&e.find('input[type="text"]').is(":focus")||(u.gallery.load(null),u.menu.toggle(!1)))})}};$("body > .top-bar > div.extend").on("click",function(e){u.menu.toggle()}),$(".filter-container > div.close > span").on("click",function(e){u.filter.toggle()}),$('.filter-container > div input[type="text"]').on("input",function(e){u.filter.apply($(e.currentTarget).val())}),$(document).on("click","body > div.menu #filter",function(e){u.filter.toggle(),u.menu.toggle()}),$(document).on("click","body > div.menu #settings",function(e){u.settings.show(),u.menu.toggle(!1)}),!0===config.gallery.enabled&&($(document).on("click","body > div.menu #gallery",function(e){u.gallery.load(null),u.menu.toggle(!1)}),$("tbody tr.file a.preview").on("click",function(e){var t;e.preventDefault(),$(e.target).is("a")&&(t=$(e.target).closest("table").find("tr.file:visible").filter(function(e,t){return 0<$(t).find("a.preview").length}).index($(e.target).closest("tr.file")),u.gallery.load(-1!==t?t:0))})),$(document).on("click","body > div.menu #copy",function(e){var t,r;u.copyTextToClipboard((t=window.location.href,r=[],$("tr.file td:first-child a:visible").each(function(e,t){var n=$(t).text().split(".").pop().toLowerCase().trim();r.includes(n)||r.push(n)}),'wget -r -np -nH -nd -e robots=off --accept "'.concat(r.join(","),'" "').concat(t,'"'))),u.menu.toggle(!1)}),$("table th span[sortable]").on("click",function(e){var t=$(e.currentTarget).parents("th"),n=t.index(),r=$(e.currentTarget).is("th")?e.currentTarget:t[0],i=$(r).parents("table").eq(0),o={directories:i.find("tbody tr.directory").toArray(),files:i.find("tbody tr.file").toArray()},a=config.sorting.hasOwnProperty("sort_by")&&(2===n||3===n);0!==config.sorting.types&&2!==config.sorting.types||a||o.directories.sort(u.comparer($(r).index())),0!==config.sorting.types&&1!==config.sorting.types||o.files.sort(u.comparer($(r).index())),r.asc=!r.asc,$("body > table span.sort-indicator").removeClass("up down"),t.find("> span.sort-indicator").addClass(r.asc?"down":"up").show();var l=u.client.get();l.hasOwnProperty("sort")||(l.sort={}),l.sort.ascending=r.asc?1:0,l.sort.row=n,u.client.set(l),r.asc||(0!==config.sorting.types&&2!==config.sorting.types||a||(o.directories=o.directories.reverse()),0!==config.sorting.types&&1!==config.sorting.types||(o.files=o.files.reverse())),Object.keys(o).forEach(function(e){return o[e].forEach(function(e){return i.append(e)})}),u.store.refresh=!0,u.store.selected=null,$("tbody tr.last").removeClass("last")}),window.addEventListener("resize",u.debounce(function(e){config.mobile=Modernizr.mq("(max-width: 640px)")})),document.addEventListener("DOMContentloaded",function(e){config.debug&&console.log("DOMContentloaded")}),$(document).ready(function(){var e;u.bind(),u.dates.load(),$('.filter-container > input[type="text"]').val(""),config.mobile=Modernizr.mq("(max-width: 640px)"),u.menu.create().css({top:$("body > div.top-bar").outerHeight()+"px",visibility:"unset",display:"none"}),!1===config.mobile&&!0===config.preview.enabled&&(e=new $.fn.imagePreview({elements:["a.preview","div.preview"],hoverDelay:config.preview.hover_delay,windowMargin:config.preview.window_margin,staticPreview:config.preview.static,extensions:{images:config.extensions.image,videos:config.extensions.video}}),!0===config.preview.cursor_indicator&&($(e).on("load",function(e,t){config.debug&&console.log("load",t)}),$(e).on("loadChange",function(e,t){$("body > table tr.file a.preview").css("cursor",t?"progress":"pointer")})))}),u.client.get(),u.sort.load(),config.debug&&console.log("config",config)}();